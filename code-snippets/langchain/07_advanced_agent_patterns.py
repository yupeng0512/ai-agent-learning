"""
é«˜çº§ Agent æ¶æ„æ¨¡å¼

æ ¸å¿ƒæ¦‚å¿µï¼š
1. ReActï¼šæœ€åŸºç¡€çš„ Agent æ¶æ„ï¼ˆå‰é¢å·²å­¦ï¼‰
2. Plan-and-Executeï¼šå…ˆè§„åˆ’å†æ‰§è¡Œï¼Œé€‚åˆå¤æ‚ä»»åŠ¡
3. Multi-Agentï¼šå¤šä¸ª Agent åä½œï¼Œå„å¸å…¶èŒ
4. Supervisorï¼šä¸»ç®¡ Agent åè°ƒå¤šä¸ªå­ Agent
5. A2A åè®®ï¼šè·¨ç³»ç»Ÿ Agent é€šä¿¡æ ‡å‡†ï¼ˆGoogle 2025ï¼‰

é€‚ç”¨åœºæ™¯ï¼š
- ReActï¼šç®€å•ä»»åŠ¡ï¼Œæ­¥éª¤å°‘
- Plan-and-Executeï¼šå¤æ‚ä»»åŠ¡ï¼Œéœ€è¦åˆ†æ­¥éª¤
- Multi-Agentï¼šä¸“ä¸šåˆ†å·¥ï¼Œå¦‚"ç ”ç©¶å‘˜+å†™æ‰‹+å®¡æ ¸å‘˜"

è¿è¡Œï¼š
cd ai-agent-learning
source .venv/bin/activate
python code-snippets/langchain/07_advanced_agent_patterns.py
"""

import os
from dotenv import load_dotenv

load_dotenv()

# API é…ç½®
IFLOW_API_KEY = os.getenv("IFLOW_API_KEY")
IFLOW_BASE_URL = os.getenv("IFLOW_BASE_URL", "https://apis.iflow.cn/v1")
IFLOW_MODEL = os.getenv("IFLOW_MODEL", "qwen3-coder-plus")


def get_llm(temperature=0):
    """è·å– LLM"""
    from langchain_openai import ChatOpenAI
    return ChatOpenAI(
        model=IFLOW_MODEL,
        openai_api_key=IFLOW_API_KEY,
        openai_api_base=IFLOW_BASE_URL,
        temperature=temperature,
    )


# ============================================================
# Demo 1: Agent æ¶æ„å¯¹æ¯”
# ============================================================

def demo_1_architecture_comparison():
    """å¯¹æ¯”ä¸åŒ Agent æ¶æ„"""
    print("\n" + "=" * 60)
    print("Demo 1: Agent æ¶æ„å¯¹æ¯”")
    print("=" * 60)
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ReAct æ¶æ„ï¼ˆå·²å­¦ï¼‰                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Thought â†’ Action â†’ Observation â†’ Thought â†’ ... â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼šè¾¹æƒ³è¾¹åšï¼Œä¸€æ­¥ä¸€æ­¥æ¥                                 â”‚
â”‚  é€‚åˆï¼šç®€å•ä»»åŠ¡ï¼Œæ­¥éª¤å°‘ï¼Œä¸éœ€è¦æå‰è§„åˆ’                     â”‚
â”‚  ç¼ºç‚¹ï¼šå®¹æ˜“è¿·å¤±æ–¹å‘ï¼Œå¤æ‚ä»»åŠ¡æ•ˆç‡ä½                         â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Plan-and-Execute æ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Planner â”‚ â†’ â”‚ Step1 â†’ Step2 â†’ Step3 â†’ Result  â”‚        â”‚
â”‚  â”‚ è§„åˆ’å™¨  â”‚    â”‚        Executor æ‰§è¡Œå™¨          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼šå…ˆåˆ¶å®šå®Œæ•´è®¡åˆ’ï¼Œå†é€æ­¥æ‰§è¡Œ                           â”‚
â”‚  é€‚åˆï¼šå¤æ‚ä»»åŠ¡ï¼Œéœ€è¦å¤šæ­¥éª¤ï¼Œæœ‰æ˜ç¡®ç›®æ ‡                     â”‚
â”‚  ä¼˜ç‚¹ï¼šä¸å®¹æ˜“è¿·å¤±ï¼Œå¯ä»¥è¿½è¸ªè¿›åº¦                             â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Multi-Agent æ¶æ„                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚       â”‚  Supervisor  â”‚  â† ä¸»ç®¡ï¼Œåˆ†é…ä»»åŠ¡                   â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚              â”‚                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚    â–¼         â–¼         â–¼                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚ â”‚Agent1â”‚ â”‚Agent2â”‚ â”‚Agent3â”‚  â† å„æœ‰ä¸“é•¿                    â”‚
â”‚ â”‚ç ”ç©¶å‘˜â”‚ â”‚å†™æ‰‹  â”‚ â”‚å®¡æ ¸å‘˜â”‚                                â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼šå¤šä¸ªä¸“ä¸š Agent åä½œï¼Œå„å¸å…¶èŒ                        â”‚
â”‚  é€‚åˆï¼šéœ€è¦å¤šç§ä¸“ä¸šèƒ½åŠ›çš„å¤æ‚ä»»åŠ¡                           â”‚
â”‚  ä¾‹å¦‚ï¼šå†™æ–‡ç« ï¼ˆç ”ç©¶â†’å†™ä½œâ†’å®¡æ ¸â†’å‘å¸ƒï¼‰                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# Demo 2: Plan-and-Execute å®ç°
# ============================================================

def demo_2_plan_and_execute():
    """Plan-and-Execute æ¶æ„æ¼”ç¤º"""
    print("\n" + "=" * 60)
    print("Demo 2: Plan-and-Execute æ¶æ„")
    print("=" * 60)
    
    from langchain_core.prompts import ChatPromptTemplate
    from langchain_core.output_parsers import StrOutputParser
    from langchain_core.tools import tool
    from typing import List
    import json
    
    llm = get_llm()
    
    # å®šä¹‰å·¥å…·ï¼ˆå•å‚æ•°ï¼Œä¾¿äºè§„åˆ’å™¨ä½¿ç”¨ï¼‰
    @tool
    def search_web(query: str) -> str:
        """æœç´¢ç½‘ç»œè·å–ä¿¡æ¯ã€‚è¾“å…¥æœç´¢å…³é”®è¯ã€‚"""
        # æ¨¡æ‹Ÿæœç´¢ç»“æœ
        mock_results = {
            "python": "Python æ˜¯ä¸€ç§é«˜çº§ç¼–ç¨‹è¯­è¨€ï¼Œç”± Guido van Rossum äº 1991 å¹´åˆ›å»ºã€‚ç‰¹ç‚¹ï¼šç®€æ´æ˜“è¯»ã€ä¸°å¯Œçš„åº“ç”Ÿæ€ã€‚",
            "ai agent": "AI Agent æ˜¯èƒ½å¤Ÿè‡ªä¸»æ„ŸçŸ¥ã€å†³ç­–ã€è¡ŒåŠ¨çš„æ™ºèƒ½ç³»ç»Ÿã€‚æ ¸å¿ƒç»„ä»¶ï¼šLLM + å·¥å…· + è®°å¿†ã€‚ä¸»è¦åº”ç”¨ï¼šæ™ºèƒ½å®¢æœã€è‡ªåŠ¨åŒ–åŠå…¬ã€ä»£ç åŠ©æ‰‹ã€‚",
            "langchain": "LangChain æ˜¯ LLM åº”ç”¨å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒ Chainã€Agentã€RAG ç­‰åŠŸèƒ½ã€‚",
        }
        for key, value in mock_results.items():
            if key in query.lower():
                return value
        return f"æœç´¢ '{query}' çš„ç»“æœï¼šè¿™æ˜¯ä¸€ä¸ªå…³äº {query} çš„é€šç”¨ä¿¡æ¯ã€‚"
    
    @tool
    def write_content(topic: str) -> str:
        """æ ¹æ®ä¸»é¢˜æ’°å†™æ–‡ç« å†…å®¹ã€‚è¾“å…¥æ–‡ç« ä¸»é¢˜ã€‚"""
        return f"""ã€{topic}ã€‘

AI Agent æ˜¯ä¸€ç§èƒ½å¤Ÿè‡ªä¸»æ„ŸçŸ¥ç¯å¢ƒã€åšå‡ºå†³ç­–å¹¶é‡‡å–è¡ŒåŠ¨çš„æ™ºèƒ½ç³»ç»Ÿã€‚

æ ¸å¿ƒç»„ä»¶ï¼š
1. LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰ï¼šä½œä¸º"å¤§è„‘"è¿›è¡Œæ¨ç†
2. å·¥å…·ï¼šä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„èƒ½åŠ›
3. è®°å¿†ï¼šå­˜å‚¨å†å²ä¿¡æ¯

åº”ç”¨åœºæ™¯ï¼šæ™ºèƒ½å®¢æœã€è‡ªåŠ¨åŒ–åŠå…¬ã€ä»£ç åŠ©æ‰‹ç­‰ã€‚

AI Agent ä»£è¡¨äº† AI ä»"è¢«åŠ¨å›ç­”"åˆ°"ä¸»åŠ¨è¡ŒåŠ¨"çš„è¿›åŒ–ã€‚"""
    
    @tool
    def save_file(filename: str) -> str:
        """ä¿å­˜æ–‡ä»¶ã€‚è¾“å…¥æ–‡ä»¶åã€‚"""
        return f"âœ… æ–‡ä»¶ '{filename}' å·²ä¿å­˜æˆåŠŸ"
    
    tools = [search_web, write_content, save_file]
    tool_names = [t.name for t in tools]
    
    # Step 1: Planner - åˆ¶å®šè®¡åˆ’
    planner_prompt = ChatPromptTemplate.from_template("""
ä½ æ˜¯ä¸€ä¸ªä»»åŠ¡è§„åˆ’ä¸“å®¶ã€‚è¯·æ ¹æ®ç”¨æˆ·çš„ç›®æ ‡ï¼Œåˆ¶å®šä¸€ä¸ªè¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’ã€‚

å¯ç”¨å·¥å…·ï¼š{tools}

ç”¨æˆ·ç›®æ ‡ï¼š{goal}

è¯·è¾“å‡ºä¸€ä¸ª JSON æ ¼å¼çš„è®¡åˆ’ï¼ŒåŒ…å«æ­¥éª¤åˆ—è¡¨ï¼š
{{
    "goal": "ç”¨æˆ·ç›®æ ‡",
    "steps": [
        {{"step": 1, "action": "å·¥å…·å", "input": "è¾“å…¥å‚æ•°", "description": "æ­¥éª¤è¯´æ˜"}},
        {{"step": 2, "action": "å·¥å…·å", "input": "è¾“å…¥å‚æ•°", "description": "æ­¥éª¤è¯´æ˜"}}
    ]
}}

åªè¾“å‡º JSONï¼Œä¸è¦å…¶ä»–å†…å®¹ã€‚
""")
    
    # Step 2: Executor - æ‰§è¡Œè®¡åˆ’
    def execute_plan(plan: dict, tools: list) -> list:
        """æ‰§è¡Œè®¡åˆ’ä¸­çš„æ¯ä¸ªæ­¥éª¤"""
        tool_map = {t.name: t for t in tools}
        results = []
        
        for step in plan.get("steps", []):
            action = step.get("action")
            input_param = step.get("input")
            
            print(f"\n  ğŸ“‹ æ‰§è¡Œæ­¥éª¤ {step.get('step')}: {step.get('description')}")
            print(f"     å·¥å…·: {action}, è¾“å…¥: {input_param}")
            
            if action in tool_map:
                result = tool_map[action].invoke(input_param)
                results.append({"step": step.get("step"), "result": result})
                print(f"     ç»“æœ: {result[:60]}...")
            else:
                results.append({"step": step.get("step"), "result": f"æœªçŸ¥å·¥å…·: {action}"})
        
        return results
    
    # æµ‹è¯•
    goal = "å†™ä¸€ç¯‡å…³äº AI Agent çš„ç®€ä»‹æ–‡ç« å¹¶ä¿å­˜"
    
    print(f"ç”¨æˆ·ç›®æ ‡: {goal}\n")
    print("=" * 40)
    print("Phase 1: è§„åˆ’")
    print("=" * 40)
    
    # ç”Ÿæˆè®¡åˆ’
    planner_chain = planner_prompt | llm | StrOutputParser()
    plan_text = planner_chain.invoke({"tools": tool_names, "goal": goal})
    
    # è§£æ JSON
    try:
        # æ¸…ç†å¯èƒ½çš„ markdown ä»£ç å—
        plan_text = plan_text.strip()
        if plan_text.startswith("```"):
            plan_text = plan_text.split("```")[1]
            if plan_text.startswith("json"):
                plan_text = plan_text[4:]
        plan = json.loads(plan_text)
    except json.JSONDecodeError:
        print(f"è®¡åˆ’è§£æå¤±è´¥ï¼ŒåŸå§‹è¾“å‡ºï¼š{plan_text[:200]}")
        return
    
    print(f"ç”Ÿæˆçš„è®¡åˆ’ï¼š")
    for step in plan.get("steps", []):
        print(f"  Step {step.get('step')}: {step.get('description')}")
    
    print("\n" + "=" * 40)
    print("Phase 2: æ‰§è¡Œ")
    print("=" * 40)
    
    # æ‰§è¡Œè®¡åˆ’
    results = execute_plan(plan, tools)
    
    print("\n" + "=" * 40)
    print("æ‰§è¡Œå®Œæˆï¼")
    print("=" * 40)
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Plan-and-Execute çš„ä¼˜åŠ¿                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. å…ˆè§„åˆ’åæ‰§è¡Œï¼Œä¸å®¹æ˜“è¿·å¤±æ–¹å‘                            â”‚
â”‚  2. å¯ä»¥è¿½è¸ªè¿›åº¦ï¼ŒçŸ¥é“å®Œæˆäº†å¤šå°‘                            â”‚
â”‚  3. è®¡åˆ’å¯ä»¥è¢«å®¡æ ¸ã€ä¿®æ”¹                                    â”‚
â”‚  4. é€‚åˆå¤æ‚çš„å¤šæ­¥éª¤ä»»åŠ¡                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# Demo 3: Multi-Agent åŸºç¡€æ¦‚å¿µ
# ============================================================

def demo_3_multi_agent_concept():
    """Multi-Agent æ¦‚å¿µä»‹ç»"""
    print("\n" + "=" * 60)
    print("Demo 3: Multi-Agent æ¦‚å¿µ")
    print("=" * 60)
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Multi-Agent ç³»ç»Ÿè®¾è®¡                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  æ ¸å¿ƒæ€æƒ³ï¼šè®©ä¸“ä¸šçš„ Agent åšä¸“ä¸šçš„äº‹                        â”‚
â”‚                                                             â”‚
â”‚  ä¾‹å­ï¼šè‡ªåŠ¨å†™æ–‡ç« ç³»ç»Ÿ                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  ç”¨æˆ·: "å†™ä¸€ç¯‡å…³äº AI Agent çš„æŠ€æœ¯åšå®¢"             â”‚   â”‚
â”‚  â”‚         â†“                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚  â”‚  Supervisor  â”‚  åˆ†æä»»åŠ¡ï¼Œåˆ†é…ç»™åˆé€‚çš„ Agent    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚         â”‚                                           â”‚   â”‚
â”‚  â”‚         â–¼                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚  â”‚  Researcher  â”‚  æœç´¢èµ„æ–™ï¼Œæ•´ç†è¦ç‚¹              â”‚   â”‚
â”‚  â”‚  â”‚    ç ”ç©¶å‘˜    â”‚  è¾“å‡ºï¼šçŸ¥è¯†ç‚¹åˆ—è¡¨                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚         â”‚                                           â”‚   â”‚
â”‚  â”‚         â–¼                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚  â”‚    Writer    â”‚  æ ¹æ®è¦ç‚¹æ’°å†™æ–‡ç«                 â”‚   â”‚
â”‚  â”‚  â”‚    å†™æ‰‹      â”‚  è¾“å‡ºï¼šæ–‡ç« è‰ç¨¿                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚         â”‚                                           â”‚   â”‚
â”‚  â”‚         â–¼                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚   â”‚
â”‚  â”‚  â”‚   Reviewer   â”‚  å®¡æ ¸æ–‡ç« ï¼Œæå‡ºä¿®æ”¹å»ºè®®          â”‚   â”‚
â”‚  â”‚  â”‚   å®¡æ ¸å‘˜     â”‚  è¾“å‡ºï¼šå®¡æ ¸æ„è§                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚   â”‚
â”‚  â”‚         â”‚                                           â”‚   â”‚
â”‚  â”‚         â–¼                                           â”‚   â”‚
â”‚  â”‚     æœ€ç»ˆæ–‡ç«                                         â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Multi-Agent çš„ä¼˜åŠ¿                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ä¸“ä¸šåˆ†å·¥ï¼šæ¯ä¸ª Agent ä¸“æ³¨ä¸€ä»¶äº‹ï¼Œæ•ˆæœæ›´å¥½              â”‚
â”‚  2. å¯æ‰©å±•ï¼šéœ€è¦æ–°èƒ½åŠ›æ—¶ï¼Œæ·»åŠ æ–° Agent                     â”‚
â”‚  3. å¯ç»´æŠ¤ï¼šå•ä¸ª Agent å‡ºé—®é¢˜ï¼Œåªéœ€ä¿®å¤é‚£ä¸€ä¸ª              â”‚
â”‚  4. å¹¶è¡Œæ‰§è¡Œï¼šç‹¬ç«‹çš„ Agent å¯ä»¥åŒæ—¶å·¥ä½œ                    â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¸¸è§ Multi-Agent æ¨¡å¼                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. é¡ºåºæ‰§è¡Œï¼šA â†’ B â†’ Cï¼ˆæµæ°´çº¿ï¼‰                          â”‚
â”‚  2. å¹¶è¡Œæ‰§è¡Œï¼šAã€Bã€C åŒæ—¶å·¥ä½œï¼Œæœ€åæ±‡æ€»                   â”‚
â”‚  3. å±‚çº§ç»“æ„ï¼šSupervisor ç®¡ç†å¤šä¸ª Worker                   â”‚
â”‚  4. åä½œå¯¹è¯ï¼šAgent ä¹‹é—´ç›¸äº’è®¨è®ºï¼Œè¾¾æˆå…±è¯†                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# Demo 4: ç®€å• Multi-Agent å®ç°
# ============================================================

def demo_4_simple_multi_agent():
    """ç®€å•çš„ Multi-Agent å®ç°"""
    print("\n" + "=" * 60)
    print("Demo 4: ç®€å• Multi-Agent å®ç°")
    print("=" * 60)
    
    from langchain_core.prompts import ChatPromptTemplate
    from langchain_core.output_parsers import StrOutputParser
    
    llm = get_llm()
    
    # Agent 1: ç ”ç©¶å‘˜
    researcher_prompt = ChatPromptTemplate.from_template("""
ä½ æ˜¯ä¸€ä¸ªç ”ç©¶å‘˜ï¼Œè´Ÿè´£æ”¶é›†å’Œæ•´ç†ä¿¡æ¯ã€‚

ä»»åŠ¡ï¼šç ”ç©¶ä»¥ä¸‹ä¸»é¢˜ï¼Œåˆ—å‡º 3-5 ä¸ªå…³é”®çŸ¥è¯†ç‚¹ã€‚

ä¸»é¢˜ï¼š{topic}

è¯·ç”¨ç®€æ´çš„è¦ç‚¹å½¢å¼è¾“å‡ºï¼Œæ¯ä¸ªè¦ç‚¹ä¸€è¡Œã€‚
""")
    
    # Agent 2: å†™æ‰‹
    writer_prompt = ChatPromptTemplate.from_template("""
ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯å†™æ‰‹ï¼Œè´Ÿè´£æ’°å†™æ¸…æ™°æ˜“æ‡‚çš„æ–‡ç« ã€‚

ä»»åŠ¡ï¼šæ ¹æ®ä»¥ä¸‹çŸ¥è¯†ç‚¹ï¼Œå†™ä¸€æ®µ 100 å­—å·¦å³çš„ä»‹ç»ã€‚

çŸ¥è¯†ç‚¹ï¼š
{points}

è¦æ±‚ï¼šé€šä¿—æ˜“æ‡‚ï¼Œé€‚åˆåˆå­¦è€…é˜…è¯»ã€‚
""")
    
    # Agent 3: å®¡æ ¸å‘˜
    reviewer_prompt = ChatPromptTemplate.from_template("""
ä½ æ˜¯ä¸€ä¸ªå†…å®¹å®¡æ ¸å‘˜ï¼Œè´Ÿè´£æ£€æŸ¥æ–‡ç« è´¨é‡ã€‚

ä»»åŠ¡ï¼šå®¡æ ¸ä»¥ä¸‹æ–‡ç« ï¼Œç»™å‡ºè¯„åˆ†ï¼ˆ1-10ï¼‰å’Œæ”¹è¿›å»ºè®®ã€‚

æ–‡ç« ï¼š
{article}

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š
è¯„åˆ†ï¼šX/10
ä¼˜ç‚¹ï¼š...
å»ºè®®ï¼š...
""")
    
    # åˆ›å»º Chain
    researcher = researcher_prompt | llm | StrOutputParser()
    writer = writer_prompt | llm | StrOutputParser()
    reviewer = reviewer_prompt | llm | StrOutputParser()
    
    # æ‰§è¡Œ Multi-Agent æµç¨‹
    topic = "ä»€ä¹ˆæ˜¯ AI Agent"
    
    print(f"ä»»åŠ¡ï¼šå†™ä¸€ç¯‡å…³äºã€Œ{topic}ã€çš„ä»‹ç»\n")
    
    # Step 1: ç ”ç©¶å‘˜æ”¶é›†ä¿¡æ¯
    print("â”€" * 40)
    print("ğŸ” Agent 1 (ç ”ç©¶å‘˜) å·¥ä½œä¸­...")
    print("â”€" * 40)
    points = researcher.invoke({"topic": topic})
    print(f"è¾“å‡ºï¼š\n{points}\n")
    
    # Step 2: å†™æ‰‹æ’°å†™æ–‡ç« 
    print("â”€" * 40)
    print("âœï¸  Agent 2 (å†™æ‰‹) å·¥ä½œä¸­...")
    print("â”€" * 40)
    article = writer.invoke({"points": points})
    print(f"è¾“å‡ºï¼š\n{article}\n")
    
    # Step 3: å®¡æ ¸å‘˜å®¡æ ¸
    print("â”€" * 40)
    print("ğŸ“ Agent 3 (å®¡æ ¸å‘˜) å·¥ä½œä¸­...")
    print("â”€" * 40)
    review = reviewer.invoke({"article": article})
    print(f"è¾“å‡ºï¼š\n{review}\n")
    
    print("=" * 40)
    print("âœ… Multi-Agent åä½œå®Œæˆï¼")
    print("=" * 40)


# ============================================================
# Demo 5: ä½¿ç”¨ LangGraph æ„å»º Multi-Agent
# ============================================================

def demo_5_langgraph_multi_agent():
    """ä½¿ç”¨ LangGraph æ„å»º Multi-Agent ç³»ç»Ÿ"""
    print("\n" + "=" * 60)
    print("Demo 5: LangGraph Multi-Agent")
    print("=" * 60)
    
    from typing import TypedDict
    from langgraph.graph import StateGraph, END
    from langchain_core.messages import HumanMessage
    
    llm = get_llm()
    
    # å®šä¹‰çŠ¶æ€
    class AgentState(TypedDict):
        task: str                    # åŸå§‹ä»»åŠ¡
        research_result: str         # ç ”ç©¶ç»“æœ
        draft: str                   # æ–‡ç« è‰ç¨¿
        review: str                  # å®¡æ ¸æ„è§
    
    # Agent èŠ‚ç‚¹å‡½æ•°
    def researcher_node(state: AgentState) -> AgentState:
        """ç ”ç©¶å‘˜èŠ‚ç‚¹"""
        print("  ğŸ” ç ”ç©¶å‘˜æ­£åœ¨å·¥ä½œ...")
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯ç ”ç©¶å‘˜ï¼Œè¯·ç ”ç©¶ä»¥ä¸‹ä¸»é¢˜ï¼Œåˆ—å‡º 3 ä¸ªå…³é”®ç‚¹ï¼š
            
ä¸»é¢˜ï¼š{state['task']}

ç”¨ç®€æ´çš„è¦ç‚¹å½¢å¼è¾“å‡ºã€‚""")
        ])
        
        return {
            **state,
            "research_result": response.content,
        }
    
    def writer_node(state: AgentState) -> AgentState:
        """å†™æ‰‹èŠ‚ç‚¹"""
        print("  âœï¸  å†™æ‰‹æ­£åœ¨å·¥ä½œ...")
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯å†™æ‰‹ï¼Œæ ¹æ®ä»¥ä¸‹è¦ç‚¹å†™ä¸€æ®µ 80 å­—çš„ä»‹ç»ï¼š

è¦ç‚¹ï¼š
{state['research_result']}

è¦æ±‚é€šä¿—æ˜“æ‡‚ã€‚""")
        ])
        
        return {
            **state,
            "draft": response.content,
        }
    
    def reviewer_node(state: AgentState) -> AgentState:
        """å®¡æ ¸å‘˜èŠ‚ç‚¹"""
        print("  ğŸ“ å®¡æ ¸å‘˜æ­£åœ¨å·¥ä½œ...")
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯å®¡æ ¸å‘˜ï¼Œè¯·å®¡æ ¸ä»¥ä¸‹æ–‡ç« ï¼Œç»™å‡ºè¯„åˆ†å’Œä¸€å¥è¯è¯„ä»·ï¼š

{state['draft']}

æ ¼å¼ï¼šè¯„åˆ† X/10ï¼Œè¯„ä»·ï¼šxxx""")
        ])
        
        return {
            **state,
            "review": response.content,
        }
    
    # æ„å»ºå›¾ï¼ˆç®€å•çš„é¡ºåºæµç¨‹ï¼‰
    workflow = StateGraph(AgentState)
    
    # æ·»åŠ èŠ‚ç‚¹
    workflow.add_node("researcher", researcher_node)
    workflow.add_node("writer", writer_node)
    workflow.add_node("reviewer", reviewer_node)
    
    # æ·»åŠ è¾¹ï¼ˆé¡ºåºæ‰§è¡Œï¼šç ”ç©¶å‘˜ â†’ å†™æ‰‹ â†’ å®¡æ ¸å‘˜ â†’ ç»“æŸï¼‰
    workflow.set_entry_point("researcher")
    workflow.add_edge("researcher", "writer")
    workflow.add_edge("writer", "reviewer")
    workflow.add_edge("reviewer", END)
    
    # ç¼–è¯‘
    app = workflow.compile()
    
    # æ‰§è¡Œ
    print("ä»»åŠ¡ï¼šå†™ä¸€ç¯‡å…³äºã€ŒRAG æŠ€æœ¯ã€çš„ä»‹ç»\n")
    print("æ‰§è¡Œæµç¨‹ï¼šç ”ç©¶å‘˜ â†’ å†™æ‰‹ â†’ å®¡æ ¸å‘˜\n")
    
    result = app.invoke({
        "task": "RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯",
        "research_result": "",
        "draft": "",
        "review": "",
    })
    
    print("\n" + "â”€" * 40)
    print("ğŸ“Š æ‰§è¡Œç»“æœ")
    print("â”€" * 40)
    print(f"\nç ”ç©¶è¦ç‚¹ï¼š\n{result['research_result']}")
    print(f"\næ–‡ç« è‰ç¨¿ï¼š\n{result['draft']}")
    print(f"\nå®¡æ ¸æ„è§ï¼š\n{result['review']}")


# ============================================================
# Demo 6: LangGraph å¹¶è¡Œæ‰§è¡Œ
# ============================================================

def demo_6_langgraph_parallel():
    """LangGraph å¹¶è¡Œæ‰§è¡Œå¤šä¸ª Agent"""
    print("\n" + "=" * 60)
    print("Demo 6: LangGraph å¹¶è¡Œæ‰§è¡Œ")
    print("=" * 60)
    
    from typing import TypedDict, List
    from langgraph.graph import StateGraph, END
    from langchain_core.messages import HumanMessage
    import time
    
    llm = get_llm()
    
    # å®šä¹‰çŠ¶æ€
    class ParallelState(TypedDict):
        topic: str                      # ç ”ç©¶ä¸»é¢˜
        tech_research: str              # æŠ€æœ¯ç ”ç©¶ç»“æœ
        market_research: str            # å¸‚åœºç ”ç©¶ç»“æœ
        competitor_research: str        # ç«å“ç ”ç©¶ç»“æœ
        final_report: str               # æœ€ç»ˆæŠ¥å‘Š
    
    # ä¸‰ä¸ªå¹¶è¡Œçš„ç ”ç©¶å‘˜ Agent
    def tech_researcher(state: ParallelState) -> ParallelState:
        """æŠ€æœ¯ç ”ç©¶å‘˜"""
        print("  ğŸ”¬ æŠ€æœ¯ç ”ç©¶å‘˜å¼€å§‹å·¥ä½œ...")
        start = time.time()
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯æŠ€æœ¯ç ”ç©¶å‘˜ï¼Œè¯·ç”¨ 2-3 å¥è¯è¯´æ˜ã€Œ{state['topic']}ã€çš„æ ¸å¿ƒæŠ€æœ¯åŸç†ã€‚""")
        ])
        
        print(f"  ğŸ”¬ æŠ€æœ¯ç ”ç©¶å‘˜å®Œæˆ ({time.time()-start:.1f}s)")
        return {**state, "tech_research": response.content}
    
    def market_researcher(state: ParallelState) -> ParallelState:
        """å¸‚åœºç ”ç©¶å‘˜"""
        print("  ğŸ“Š å¸‚åœºç ”ç©¶å‘˜å¼€å§‹å·¥ä½œ...")
        start = time.time()
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯å¸‚åœºç ”ç©¶å‘˜ï¼Œè¯·ç”¨ 2-3 å¥è¯è¯´æ˜ã€Œ{state['topic']}ã€çš„å¸‚åœºåº”ç”¨åœºæ™¯ã€‚""")
        ])
        
        print(f"  ğŸ“Š å¸‚åœºç ”ç©¶å‘˜å®Œæˆ ({time.time()-start:.1f}s)")
        return {**state, "market_research": response.content}
    
    def competitor_researcher(state: ParallelState) -> ParallelState:
        """ç«å“ç ”ç©¶å‘˜"""
        print("  ğŸ” ç«å“ç ”ç©¶å‘˜å¼€å§‹å·¥ä½œ...")
        start = time.time()
        
        response = llm.invoke([
            HumanMessage(content=f"""ä½ æ˜¯ç«å“ç ”ç©¶å‘˜ï¼Œè¯·ç”¨ 2-3 å¥è¯åˆ—ä¸¾ã€Œ{state['topic']}ã€é¢†åŸŸçš„ä¸»è¦ç©å®¶/äº§å“ã€‚""")
        ])
        
        print(f"  ğŸ” ç«å“ç ”ç©¶å‘˜å®Œæˆ ({time.time()-start:.1f}s)")
        return {**state, "competitor_research": response.content}
    
    # æ±‡æ€»èŠ‚ç‚¹
    def aggregator(state: ParallelState) -> ParallelState:
        """æ±‡æ€»æ‰€æœ‰ç ”ç©¶ç»“æœ"""
        print("  ğŸ“ æ±‡æ€»å‘˜æ­£åœ¨æ•´åˆæŠ¥å‘Š...")
        
        response = llm.invoke([
            HumanMessage(content=f"""è¯·å°†ä»¥ä¸‹ä¸‰ä¸ªç ”ç©¶æŠ¥å‘Šæ•´åˆæˆä¸€æ®µ 100 å­—çš„ç»¼åˆæŠ¥å‘Šï¼š

æŠ€æœ¯åˆ†æï¼š{state['tech_research']}

å¸‚åœºåˆ†æï¼š{state['market_research']}

ç«å“åˆ†æï¼š{state['competitor_research']}

è¾“å‡ºä¸€æ®µè¿è´¯çš„ç»¼åˆæŠ¥å‘Šã€‚""")
        ])
        
        return {**state, "final_report": response.content}
    
    # æ„å»ºå¹¶è¡Œå›¾
    workflow = StateGraph(ParallelState)
    
    # æ·»åŠ èŠ‚ç‚¹
    workflow.add_node("tech_researcher", tech_researcher)
    workflow.add_node("market_researcher", market_researcher)
    workflow.add_node("competitor_researcher", competitor_researcher)
    workflow.add_node("aggregator", aggregator)
    
    # è®¾ç½®å…¥å£ç‚¹ - åŒæ—¶æŒ‡å‘ä¸‰ä¸ªç ”ç©¶å‘˜ï¼ˆå¹¶è¡Œï¼‰
    workflow.set_entry_point("tech_researcher")
    
    # å…³é”®ï¼šä¸‰ä¸ªç ”ç©¶å‘˜éƒ½ä»å…¥å£å¼€å§‹ï¼Œéƒ½æŒ‡å‘æ±‡æ€»èŠ‚ç‚¹
    # LangGraph ä¼šè‡ªåŠ¨å¹¶è¡Œæ‰§è¡Œæ²¡æœ‰ä¾èµ–å…³ç³»çš„èŠ‚ç‚¹
    workflow.add_edge("tech_researcher", "aggregator")
    
    # ä¸ºäº†å®ç°çœŸæ­£çš„å¹¶è¡Œï¼Œéœ€è¦ä½¿ç”¨ fan-out/fan-in æ¨¡å¼
    # è¿™é‡Œç”¨ä¸€ä¸ªç®€åŒ–çš„æ–¹å¼æ¼”ç¤ºï¼šæ‰‹åŠ¨å¹¶è¡Œè°ƒç”¨
    
    # ç¼–è¯‘
    app = workflow.compile()
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹¶è¡Œæ‰§è¡Œæ¶æ„                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                    â”Œâ†’ ğŸ”¬ æŠ€æœ¯ç ”ç©¶å‘˜ â”€â”                      â”‚
â”‚                    â”‚                  â”‚                      â”‚
â”‚  START â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â†’ ğŸ“Š å¸‚åœºç ”ç©¶å‘˜ â”€â”¼â†’ ğŸ“ æ±‡æ€» â†’ END      â”‚
â”‚                    â”‚                  â”‚                      â”‚
â”‚                    â””â†’ ğŸ” ç«å“ç ”ç©¶å‘˜ â”€â”˜                      â”‚
â”‚                                                             â”‚
â”‚  ä¸‰ä¸ªç ”ç©¶å‘˜å¹¶è¡Œå·¥ä½œï¼Œæœ€åæ±‡æ€»ç»“æœ                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")
    
    # æ‰‹åŠ¨å®ç°å¹¶è¡Œï¼ˆæ¼”ç¤ºæ¦‚å¿µï¼‰
    import concurrent.futures
    
    topic = "AI Agent"
    initial_state = {
        "topic": topic,
        "tech_research": "",
        "market_research": "",
        "competitor_research": "",
        "final_report": "",
    }
    
    print(f"ç ”ç©¶ä¸»é¢˜ï¼š{topic}\n")
    print("â”€" * 40)
    print("å¹¶è¡Œæ‰§è¡Œä¸‰ä¸ªç ”ç©¶å‘˜...")
    print("â”€" * 40)
    
    start_time = time.time()
    
    # å¹¶è¡Œæ‰§è¡Œä¸‰ä¸ªç ”ç©¶å‘˜
    with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:
        futures = {
            executor.submit(tech_researcher, initial_state): "tech",
            executor.submit(market_researcher, initial_state): "market",
            executor.submit(competitor_researcher, initial_state): "competitor",
        }
        
        results = {}
        for future in concurrent.futures.as_completed(futures):
            result = future.result()
            if result.get("tech_research"):
                results["tech_research"] = result["tech_research"]
            if result.get("market_research"):
                results["market_research"] = result["market_research"]
            if result.get("competitor_research"):
                results["competitor_research"] = result["competitor_research"]
    
    parallel_time = time.time() - start_time
    print(f"\nå¹¶è¡Œæ‰§è¡Œæ€»è€—æ—¶: {parallel_time:.1f}s")
    
    # æ±‡æ€»
    print("\n" + "â”€" * 40)
    print("æ±‡æ€»é˜¶æ®µ...")
    print("â”€" * 40)
    
    final_state = {
        "topic": topic,
        **results,
        "final_report": "",
    }
    final_result = aggregator(final_state)
    
    print("\n" + "â”€" * 40)
    print("ğŸ“Š ç ”ç©¶æŠ¥å‘Š")
    print("â”€" * 40)
    print(f"\nğŸ”¬ æŠ€æœ¯åˆ†æï¼š\n{results.get('tech_research', 'N/A')}")
    print(f"\nğŸ“Š å¸‚åœºåˆ†æï¼š\n{results.get('market_research', 'N/A')}")
    print(f"\nğŸ” ç«å“åˆ†æï¼š\n{results.get('competitor_research', 'N/A')}")
    print(f"\nğŸ“ ç»¼åˆæŠ¥å‘Šï¼š\n{final_result['final_report']}")
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹¶è¡Œ vs ä¸²è¡Œ                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ä¸²è¡Œï¼šA(3s) â†’ B(3s) â†’ C(3s) = 9s                          â”‚
â”‚  å¹¶è¡Œï¼šA(3s) + B(3s) + C(3s) = 3sï¼ˆåŒæ—¶æ‰§è¡Œï¼‰              â”‚
â”‚                                                             â”‚
â”‚  é€‚ç”¨åœºæ™¯ï¼š                                                 â”‚
â”‚  - å¤šä¸ªç‹¬ç«‹çš„ç ”ç©¶/åˆ†æä»»åŠ¡                                 â”‚
â”‚  - å¤šä¸ªæ•°æ®æºçš„å¹¶è¡Œè·å–                                    â”‚
â”‚  - å¤šä¸ªç‹¬ç«‹çš„æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œ                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# Demo 7: Agent æ¶æ„é€‰æ‹©æŒ‡å—
# ============================================================

def demo_7_architecture_guide():
    """Agent æ¶æ„é€‰æ‹©æŒ‡å—"""
    print("\n" + "=" * 60)
    print("Demo 6: Agent æ¶æ„é€‰æ‹©æŒ‡å—")
    print("=" * 60)
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¦‚ä½•é€‰æ‹© Agent æ¶æ„ï¼Ÿ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  é—®è‡ªå·±å‡ ä¸ªé—®é¢˜ï¼š                                           â”‚
â”‚                                                             â”‚
â”‚  Q1: ä»»åŠ¡å¤æ‚åº¦å¦‚ä½•ï¼Ÿ                                       â”‚
â”‚  â”œâ”€ ç®€å•ï¼ˆ1-3æ­¥ï¼‰â†’ ReAct                                   â”‚
â”‚  â””â”€ å¤æ‚ï¼ˆå¤šæ­¥éª¤ï¼‰â†’ Plan-and-Execute æˆ– Multi-Agent        â”‚
â”‚                                                             â”‚
â”‚  Q2: éœ€è¦å¤šç§ä¸“ä¸šèƒ½åŠ›å—ï¼Ÿ                                   â”‚
â”‚  â”œâ”€ ä¸éœ€è¦ â†’ ReAct æˆ– Plan-and-Execute                     â”‚
â”‚  â””â”€ éœ€è¦ â†’ Multi-Agentï¼ˆä¸“ä¸šåˆ†å·¥ï¼‰                         â”‚
â”‚                                                             â”‚
â”‚  Q3: ä»»åŠ¡å¯ä»¥å¹¶è¡Œå—ï¼Ÿ                                       â”‚
â”‚  â”œâ”€ å¿…é¡»é¡ºåºæ‰§è¡Œ â†’ Plan-and-Execute                        â”‚
â”‚  â””â”€ å¯ä»¥å¹¶è¡Œ â†’ Multi-Agentï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰                     â”‚
â”‚                                                             â”‚
â”‚  Q4: éœ€è¦äººå·¥ä»‹å…¥å—ï¼Ÿ                                       â”‚
â”‚  â”œâ”€ ä¸éœ€è¦ â†’ ä»»ä½•æ¶æ„                                      â”‚
â”‚  â””â”€ éœ€è¦å®¡æ‰¹/ç¡®è®¤ â†’ Plan-and-Executeï¼ˆè®¡åˆ’å¯å®¡æ ¸ï¼‰         â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®é™…æ¡ˆä¾‹                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  åœºæ™¯ 1ï¼šæ™ºèƒ½å®¢æœ                                           â”‚
â”‚  â†’ ReActï¼ˆæŸ¥çŸ¥è¯†åº“ + å›ç­”ï¼Œæ­¥éª¤å°‘ï¼‰                        â”‚
â”‚                                                             â”‚
â”‚  åœºæ™¯ 2ï¼šè‡ªåŠ¨å†™ç ”æŠ¥                                         â”‚
â”‚  â†’ Multi-Agentï¼ˆç ”ç©¶å‘˜æ”¶é›† â†’ åˆ†æå¸ˆåˆ†æ â†’ å†™æ‰‹æ’°å†™ï¼‰       â”‚
â”‚                                                             â”‚
â”‚  åœºæ™¯ 3ï¼šä»£ç é‡æ„                                           â”‚
â”‚  â†’ Plan-and-Executeï¼ˆå…ˆè§„åˆ’æ”¹å“ªäº›æ–‡ä»¶ï¼Œå†é€ä¸ªä¿®æ”¹ï¼‰        â”‚
â”‚                                                             â”‚
â”‚  åœºæ™¯ 4ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•                                         â”‚
â”‚  â†’ Multi-Agent + å¹¶è¡Œï¼ˆå¤šä¸ªæµ‹è¯• Agent åŒæ—¶æ‰§è¡Œï¼‰           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¢è¯•å¸¸é—®                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Q: ReAct å’Œ Plan-and-Execute çš„åŒºåˆ«ï¼Ÿ                     â”‚
â”‚  A: ReAct è¾¹æƒ³è¾¹åšï¼ŒPlan-Execute å…ˆè§„åˆ’å†æ‰§è¡Œ              â”‚
â”‚     ReAct é€‚åˆç®€å•ä»»åŠ¡ï¼ŒPlan-Execute é€‚åˆå¤æ‚ä»»åŠ¡          â”‚
â”‚                                                             â”‚
â”‚  Q: ä»€ä¹ˆæ—¶å€™ç”¨ Multi-Agentï¼Ÿ                               â”‚
â”‚  A: éœ€è¦å¤šç§ä¸“ä¸šèƒ½åŠ›åä½œæ—¶ï¼Œå¦‚å†™æ–‡ç« ï¼ˆç ”ç©¶+å†™ä½œ+å®¡æ ¸ï¼‰     â”‚
â”‚                                                             â”‚
â”‚  Q: Multi-Agent çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿ                             â”‚
â”‚  A: Agent ä¹‹é—´çš„åè°ƒã€çŠ¶æ€ä¼ é€’ã€é”™è¯¯å¤„ç†                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# Demo 8: A2A åè®®ä¸ Multi-Agent çš„å…³ç³»
# ============================================================

def demo_8_a2a_protocol():
    """A2A åè®®ä»‹ç»"""
    print("\n" + "=" * 60)
    print("Demo 8: A2A åè®® (Agent-to-Agent)")
    print("=" * 60)
    
    print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»€ä¹ˆæ˜¯ A2Aï¼Ÿ                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  A2A (Agent-to-Agent) æ˜¯ Google äº 2025 å¹´ 4 æœˆæå‡ºçš„      â”‚
â”‚  å¼€æ”¾åè®®ï¼Œå®šä¹‰äº†ä¸åŒ Agent ç³»ç»Ÿä¹‹é—´å¦‚ä½•é€šä¿¡å’Œåä½œã€‚        â”‚
â”‚                                                             â”‚
â”‚  ç±»æ¯”ï¼š                                                     â”‚
â”‚  - HTTP æ˜¯ Web çš„é€šä¿¡åè®®                                   â”‚
â”‚  - A2A æ˜¯ Agent çš„é€šä¿¡åè®®                                  â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A2A vs Multi-Agent                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Multi-Agentï¼ˆæ¶æ„æ¨¡å¼ï¼‰                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  - æè¿°"å¤šä¸ª Agent å¦‚ä½•åä½œ"                       â”‚   â”‚
â”‚  â”‚  - å…³æ³¨ï¼šä»»åŠ¡åˆ†å·¥ã€çŠ¶æ€ä¼ é€’ã€æµç¨‹æ§åˆ¶               â”‚   â”‚
â”‚  â”‚  - é€šå¸¸åœ¨åŒä¸€ä¸ªç³»ç»Ÿ/ä»£ç åº“å†…                       â”‚   â”‚
â”‚  â”‚  - ä¾‹å¦‚ï¼šç ”ç©¶å‘˜ â†’ å†™æ‰‹ â†’ å®¡æ ¸å‘˜                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  A2Aï¼ˆé€šä¿¡åè®®ï¼‰                                    â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚  - æè¿°"ä¸åŒç³»ç»Ÿçš„ Agent å¦‚ä½•äº’ç›¸å‘ç°å’Œé€šä¿¡"       â”‚   â”‚
â”‚  â”‚  - å…³æ³¨ï¼šè·¨ç³»ç»Ÿäº’æ“ä½œã€æ ‡å‡†åŒ–æ¥å£                   â”‚   â”‚
â”‚  â”‚  - è®©ä¸åŒå…¬å¸å¼€å‘çš„ Agent èƒ½å¤Ÿåä½œ                 â”‚   â”‚
â”‚  â”‚  - ä¾‹å¦‚ï¼šå…¬å¸Açš„Agent â†â†’ å…¬å¸Bçš„Agent              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸‰å¤§åè®®å¯¹æ¯”                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ åè®®     â”‚ è§£å†³ä»€ä¹ˆé—®é¢˜    â”‚ ç±»æ¯”                â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ MCP      â”‚ Agent è°ƒç”¨å·¥å…·  â”‚ USB æ¥å£æ ‡å‡†        â”‚      â”‚
â”‚  â”‚ A2A      â”‚ Agent ä¹‹é—´é€šä¿¡  â”‚ HTTP åè®®           â”‚      â”‚
â”‚  â”‚ Function â”‚ LLM è°ƒç”¨å‡½æ•°    â”‚ API è°ƒç”¨            â”‚      â”‚
â”‚  â”‚ Calling  â”‚                 â”‚                     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A2A çš„æ ¸å¿ƒæ¦‚å¿µ                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Agent Cardï¼ˆAgent åç‰‡ï¼‰                                â”‚
â”‚     - æè¿° Agent çš„èƒ½åŠ›ã€æ¥å£ã€è®¤è¯æ–¹å¼                    â”‚
â”‚     - ç±»ä¼¼æœåŠ¡å‘ç°ï¼Œè®©å…¶ä»– Agent çŸ¥é“"æˆ‘èƒ½åšä»€ä¹ˆ"          â”‚
â”‚                                                             â”‚
â”‚  2. Taskï¼ˆä»»åŠ¡ï¼‰                                            â”‚
â”‚     - Agent ä¹‹é—´ä¼ é€’çš„å·¥ä½œå•å…ƒ                              â”‚
â”‚     - åŒ…å«è¾“å…¥ã€è¾“å‡ºã€çŠ¶æ€ç­‰ä¿¡æ¯                            â”‚
â”‚                                                             â”‚
â”‚  3. Messageï¼ˆæ¶ˆæ¯ï¼‰                                         â”‚
â”‚     - Agent ä¹‹é—´çš„é€šä¿¡å†…å®¹                                  â”‚
â”‚     - æ”¯æŒæ–‡æœ¬ã€æ–‡ä»¶ã€ç»“æ„åŒ–æ•°æ®ç­‰                          â”‚
â”‚                                                             â”‚
â”‚  4. Artifactï¼ˆäº§ç‰©ï¼‰                                        â”‚
â”‚     - ä»»åŠ¡æ‰§è¡Œçš„è¾“å‡ºç»“æœ                                    â”‚
â”‚     - å¯ä»¥æ˜¯æ–‡ä»¶ã€æ•°æ®ã€æˆ–å…¶ä»– Agent å¯ç”¨çš„èµ„æº            â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A2A è§£å†³çš„é—®é¢˜                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  æ²¡æœ‰ A2Aï¼š                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      ï¼Ÿï¼Ÿï¼Ÿ      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ å…¬å¸Açš„  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ å…¬å¸Bçš„  â”‚                  â”‚
â”‚  â”‚ Agent   â”‚   å¦‚ä½•é€šä¿¡ï¼Ÿ     â”‚ Agent   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   å„è‡ªæ¥å£ä¸åŒ   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  æœ‰äº† A2Aï¼š                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    A2A åè®®     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ å…¬å¸Açš„  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ å…¬å¸Bçš„  â”‚                  â”‚
â”‚  â”‚ Agent   â”‚   æ ‡å‡†åŒ–é€šä¿¡     â”‚ Agent   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼š                                             â”‚
â”‚  - ä½ çš„"æ—…è¡Œè§„åˆ’ Agent"éœ€è¦è°ƒç”¨"æœºç¥¨é¢„è®¢ Agent"          â”‚
â”‚  - æœºç¥¨ Agent æ˜¯å¦ä¸€å®¶å…¬å¸å¼€å‘çš„                           â”‚
â”‚  - A2A è®©å®ƒä»¬èƒ½å¤Ÿ"è¯´åŒä¸€ç§è¯­è¨€"                           â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A2A ä¸ MCP çš„å…³ç³»                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  MCP (Model Context Protocol)ï¼š                             â”‚
â”‚  - Agent â†’ å·¥å…·ï¼ˆå•å‘è°ƒç”¨ï¼‰                                â”‚
â”‚  - ä¾‹å¦‚ï¼šAgent è°ƒç”¨æœç´¢å·¥å…·ã€æ•°æ®åº“å·¥å…·                    â”‚
â”‚                                                             â”‚
â”‚  A2A (Agent-to-Agent)ï¼š                                     â”‚
â”‚  - Agent â†” Agentï¼ˆåŒå‘åä½œï¼‰                               â”‚
â”‚  - ä¾‹å¦‚ï¼šè§„åˆ’Agent ä¸ æ‰§è¡ŒAgent åä½œå®Œæˆä»»åŠ¡               â”‚
â”‚                                                             â”‚
â”‚  ä¸¤è€…äº’è¡¥ï¼š                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  A2A   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚  â”‚ Agent A â”‚ â†â”€â”€â”€â”€â†’ â”‚ Agent B â”‚                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚       â”‚ MCP              â”‚ MCP                      â”‚   â”‚
â”‚  â”‚       â–¼                  â–¼                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚  â”‚ å·¥å…·é›†  â”‚        â”‚ å·¥å…·é›†  â”‚                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¢è¯•è¦ç‚¹                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Q: A2A å’Œ Multi-Agent æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ                        â”‚
â”‚  A: Multi-Agent æ˜¯æ¶æ„æ¨¡å¼ï¼Œæè¿°å¤šAgentå¦‚ä½•åä½œ            â”‚
â”‚     A2A æ˜¯é€šä¿¡åè®®ï¼Œè§£å†³è·¨ç³»ç»ŸAgentäº’æ“ä½œé—®é¢˜              â”‚
â”‚                                                             â”‚
â”‚  Q: A2A å’Œ MCP æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ                                â”‚
â”‚  A: MCP æ˜¯ Agent è°ƒç”¨å·¥å…·çš„åè®®ï¼ˆAgentâ†’Toolï¼‰              â”‚
â”‚     A2A æ˜¯ Agent ä¹‹é—´é€šä¿¡çš„åè®®ï¼ˆAgentâ†”Agentï¼‰             â”‚
â”‚                                                             â”‚
â”‚  Q: ä¸ºä»€ä¹ˆéœ€è¦ A2Aï¼Ÿ                                       â”‚
â”‚  A: è®©ä¸åŒå‚å•†ã€ä¸åŒç³»ç»Ÿçš„ Agent èƒ½å¤Ÿäº’ç›¸å‘ç°å’Œåä½œ        â”‚
â”‚     æ„å»ºæ›´å¤§è§„æ¨¡çš„ Agent ç”Ÿæ€ç³»ç»Ÿ                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")


# ============================================================
# ä¸»å‡½æ•°
# ============================================================

if __name__ == "__main__":
    if not IFLOW_API_KEY:
        print("é”™è¯¯: è¯·åœ¨ .env æ–‡ä»¶ä¸­é…ç½® IFLOW_API_KEY")
        exit(1)
    
    print("=" * 60)
    print("é«˜çº§ Agent æ¶æ„æ¨¡å¼")
    print("=" * 60)
    print(f"ä½¿ç”¨æ¨¡å‹: {IFLOW_MODEL}")
    
    demo_1_architecture_comparison()
    demo_2_plan_and_execute()
    demo_3_multi_agent_concept()
    demo_4_simple_multi_agent()
    demo_5_langgraph_multi_agent()
    demo_6_langgraph_parallel()
    demo_7_architecture_guide()
    demo_8_a2a_protocol()
    
    print("\n" + "=" * 60)
    print("é«˜çº§ Agent æ¶æ„æ•™ç¨‹å®Œæˆï¼")
    print("=" * 60)
    print("""
æ ¸å¿ƒè¦ç‚¹ï¼š

1. ä¸‰ç§ä¸»è¦æ¶æ„
   - ReActï¼šè¾¹æƒ³è¾¹åšï¼Œé€‚åˆç®€å•ä»»åŠ¡
   - Plan-and-Executeï¼šå…ˆè§„åˆ’åæ‰§è¡Œï¼Œé€‚åˆå¤æ‚ä»»åŠ¡
   - Multi-Agentï¼šä¸“ä¸šåˆ†å·¥ï¼Œé€‚åˆéœ€è¦å¤šç§èƒ½åŠ›çš„ä»»åŠ¡

2. å¹¶è¡Œ vs ä¸²è¡Œ
   - ä¸²è¡Œï¼šA â†’ B â†’ Cï¼ˆæœ‰ä¾èµ–å…³ç³»ï¼‰
   - å¹¶è¡Œï¼šA + B + C åŒæ—¶æ‰§è¡Œï¼ˆç‹¬ç«‹ä»»åŠ¡ï¼‰

3. Agent åè®®ç”Ÿæ€
   - MCPï¼šAgent è°ƒç”¨å·¥å…·çš„åè®®ï¼ˆAgent â†’ Toolï¼‰
   - A2Aï¼šAgent ä¹‹é—´é€šä¿¡çš„åè®®ï¼ˆAgent â†” Agentï¼‰
   - ä¸¤è€…äº’è¡¥ï¼Œæ„å»ºå®Œæ•´çš„ Agent ç”Ÿæ€

4. LangGraph æ˜¯æ„å»ºå¤æ‚ Agent çš„åˆ©å™¨
   - çŠ¶æ€ç®¡ç†
   - æµç¨‹æ§åˆ¶ï¼ˆä¸²è¡Œ/å¹¶è¡Œï¼‰
   - æ¡ä»¶è·¯ç”±

é¢è¯•è¦ç‚¹ï¼š
- ä¸åŒæ¶æ„çš„é€‚ç”¨åœºæ™¯
- Multi-Agent çš„åè°ƒæœºåˆ¶
- A2A å’Œ MCP çš„åŒºåˆ«
- å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ¶æ„

ä¸‹ä¸€æ­¥ï¼šå­¦ä¹  Agent çš„è¯„ä¼°ä¸ä¼˜åŒ–ã€ç”Ÿäº§éƒ¨ç½²
""")
